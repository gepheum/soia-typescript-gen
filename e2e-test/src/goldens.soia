struct UnitTest {
  test_number: int32;
  assertion: Assertion;
}

enum Assertion {
  struct BytesEqual {
    actual: BytesExpression;
    expected: BytesExpression;
  }
  bytes_equal: BytesEqual;

  struct StringEqual {
    actual: StringExpression;
    expected: StringExpression;
  }
  string_equal: StringEqual;

  struct ValueBundle {
    value: TypedValue;
    expected_dense_json: string;
    expected_readable_json: string;
    alternative_jsons: [StringExpression];
    expected_bytes: bytes;
    alternative_bytes: [BytesExpression];
    expected_type_descriptor: string?;
  }
  value_bundle: ValueBundle;
}

enum StringExpression {
  literal: string;
  to_dense_json: TypedValue;
  to_readable_json: TypedValue;
  point_to_dense_json: PointExpression;
  point_to_readable_json: PointExpression;
}

enum BytesExpression {
  literal: bytes;
  to_bytes: TypedValue;
  point_to_bytes: PointExpression;
}

enum TypedValue {
  bool: bool;
  int32: int32;
  int64: int64;
  uint64: uint64;
  float32: float32;
  float64: float64;
  timestamp: timestamp;
  string: string;
  bytes: bytes;
  bool_optional: bool?;
  ints: [int32];
  point: Point;
  color: Color;
  round_trip_dense_json: TypedValue;
  round_trip_readable_json: TypedValue;
  round_trip_bytes: TypedValue;
}

enum PointExpression {
  literal: Point;
  from_json_keep_unrecognized: StringExpression;
  from_json_drop_unrecognized: StringExpression;
  from_bytes_keep_unrecognized: BytesExpression;
  from_bytes_drop_unrecognized: BytesExpression;
}

struct Point {
  x: int32;
  removed;
  y: int32;
}

struct Color {
  r: int32;
  g: int32;
  b: int32;
  removed;
}

const UNIT_TESTS: [UnitTest] = [
  {
    test_number: 1000,
    assertion: {
      kind: "value_bundle",
      value: {
        value: {
          kind: "bool",
          value: true,
        },
        expected_dense_json: "1",
        expected_readable_json: "true",
        alternative_jsons: [
          {
            kind: "literal",
            value: "3.14",
          },
          {
            kind: "literal",
            value: "-1",
          },
          {
            kind: "literal",
            value: '"-Infinity"',
          },
          {
            kind: "literal",
            value: '"1"',
          },
        ],
        expected_bytes: "hex:736f696101",
        alternative_bytes: [
          {
            kind: "to_bytes",
            value: {
              kind: "float32",
              value: 3.14,
            },
          },
        ],
        expected_type_descriptor: "{\n  \"type\": {\n    \"kind\": \"primitive\",\n    \"value\": \"bool\"\n  },\n  \"records\": []\n}",
      },
    },
  },
  {
    test_number: 1001,
    assertion: {
      kind: "value_bundle",
      value: {
        value: {
          kind: "bool",
          value: false,
        },
        expected_dense_json: "0",
        expected_readable_json: "false",
        expected_bytes: "hex:736f696100",
        alternative_jsons: [
          {
            kind: "literal",
            value: "0.0",
          },
          {
            kind: "literal",
            value: "-0.0",
          },
          {
            kind: "literal",
            value: "\"0\"",
          },
        ],
        alternative_bytes: [],
        expected_type_descriptor: null,
      },
    },
  },
  {
    test_number: 1002,
    assertion: {
      kind: "value_bundle",
      value: {
        value: {
          kind: "timestamp",
          value: "1970-01-01T00:00:00.000Z",
        },
        expected_dense_json: "0",
        expected_readable_json: '{\n  "unix_millis": 0,\n  "formatted": "1970-01-01T00:00:00.000Z"\n}',
        expected_bytes: "hex:736f696100",
        alternative_jsons: [
          {
            kind: "literal",
            value: "0.0",
          },
        ],
        alternative_bytes: [],
        expected_type_descriptor: "{\n  \"type\": {\n    \"kind\": \"primitive\",\n    \"value\": \"timestamp\"\n  },\n  \"records\": []\n}",
      },
    },
  },
  {
    test_number: 1003,
    assertion: {
      kind: "value_bundle",
      value: {
        value: {
          kind: "timestamp",
          value: "2023-08-25T21:30:34.586Z",
        },
        expected_dense_json: "1692999034586",
        expected_readable_json: '{\n  "unix_millis": 1692999034586,\n  "formatted": "2023-08-25T21:30:34.586Z"\n}',
        expected_bytes: "hex:736f6961efda269b2e8a010000",
        alternative_jsons: [
          {
            kind: "literal",
            value: "\"1692999034586\"",
          },
        ],
        alternative_bytes: [
          {
            kind: "to_bytes",
            value: {
              kind: "float64",
              value: 1692999034586.1,
            },
          },
        ],
        expected_type_descriptor: null,
      },
    },
  },
  {
    test_number: 1004,
    assertion: {
      kind: "value_bundle",
      value: {
        value: {
          kind: "int32",
          value: 2,
        },
        expected_dense_json: "2",
        expected_readable_json: "2",
        expected_bytes: "hex:736f696102",
        alternative_jsons: [
          {
            kind: "literal",
            value: "\"2\"",
          },
        ],
        alternative_bytes: [
          {
            kind: "to_bytes",
            value: {
              kind: "float64",
              value: 2.0,
            },
          },
        ],
        expected_type_descriptor: "{\n  \"type\": {\n    \"kind\": \"primitive\",\n    \"value\": \"int32\"\n  },\n  \"records\": []\n}",
      },
    },
  },
  {
    test_number: 1005,
    assertion: {
      kind: "value_bundle",
      value: {
        value: {
          kind: "int32",
          value: -1,
        },
        expected_dense_json: "-1",
        expected_readable_json: "-1",
        expected_bytes: "hex:736f6961ebff",
        alternative_jsons: [
          {
            kind: "literal",
            value: "\"-1\"",
          },
        ],
        alternative_bytes: [],
        expected_type_descriptor: null,
      },
    },
  },
  {
    test_number: 1006,
    assertion: {
      kind: "value_bundle",
      value: {
        value: {
          kind: "int32",
          value: 231,
        },
        expected_dense_json: "231",
        expected_readable_json: "231",
        expected_bytes: "hex:736f6961e7",
        alternative_jsons: [],
        alternative_bytes: [],
        expected_type_descriptor: null,
      },
    },
  },
  {
    test_number: 1007,
    assertion: {
      kind: "value_bundle",
      value: {
        value: {
          kind: "int32",
          value: 232,
        },
        expected_dense_json: "232",
        expected_readable_json: "232",
        expected_bytes: "hex:736f6961e8e800",
        alternative_jsons: [],
        alternative_bytes: [],
        expected_type_descriptor: null,
      },
    },
  },
  {
    test_number: 1008,
    assertion: {
      kind: "value_bundle",
      value: {
        value: {
          kind: "int32",
          value: 65535,
        },
        expected_dense_json: "65535",
        expected_readable_json: "65535",
        expected_bytes: "hex:736f6961e8ffff",
        alternative_jsons: [],
        alternative_bytes: [],
        expected_type_descriptor: null,
      },
    },
  },
  {
    test_number: 1009,
    assertion: {
      kind: "value_bundle",
      value: {
        value: {
          kind: "int32",
          value: 65536,
        },
        expected_dense_json: "65536",
        expected_readable_json: "65536",
        expected_bytes: "hex:736f6961e900000100",
        alternative_jsons: [],
        alternative_bytes: [],
        expected_type_descriptor: null,
      },
    },
  },
  {
    test_number: 1010,
    assertion: {
      kind: "value_bundle",
      value: {
        value: {
          kind: "int32",
          value: 2147483647,
        },
        expected_dense_json: "2147483647",
        expected_readable_json: "2147483647",
        expected_bytes: "hex:736f6961e9ffffff7f",
        alternative_jsons: [],
        alternative_bytes: [],
        expected_type_descriptor: null,
      },
    },
  },
  {
    test_number: 1011,
    assertion: {
      kind: "value_bundle",
      value: {
        value: {
          kind: "int32",
          value: -255,
        },
        expected_dense_json: "-255",
        expected_readable_json: "-255",
        expected_bytes: "hex:736f6961eb01",
        alternative_jsons: [],
        alternative_bytes: [],
        expected_type_descriptor: null,
      },
    },
  },
  {
    test_number: 1012,
    assertion: {
      kind: "value_bundle",
      value: {
        value: {
          kind: "int32",
          value: -256,
        },
        expected_dense_json: "-256",
        expected_readable_json: "-256",
        expected_bytes: "hex:736f6961eb00",
        alternative_jsons: [],
        alternative_bytes: [],
        expected_type_descriptor: null,
      },
    },
  },
  {
    test_number: 1013,
    assertion: {
      kind: "value_bundle",
      value: {
        value: {
          kind: "int32",
          value: -257,
        },
        expected_dense_json: "-257",
        expected_readable_json: "-257",
        expected_bytes: "hex:736f6961ecfffe",
        alternative_jsons: [],
        alternative_bytes: [],
        expected_type_descriptor: null,
      },
    },
  },
  {
    test_number: 1014,
    assertion: {
      kind: "value_bundle",
      value: {
        value: {
          kind: "int32",
          value: -65536,
        },
        expected_dense_json: "-65536",
        expected_readable_json: "-65536",
        expected_bytes: "hex:736f6961ec0000",
        alternative_jsons: [],
        alternative_bytes: [],
        expected_type_descriptor: null,
      },
    },
  },
  {
    test_number: 1015,
    assertion: {
      kind: "value_bundle",
      value: {
        value: {
          kind: "int32",
          value: -65537,
        },
        expected_dense_json: "-65537",
        expected_readable_json: "-65537",
        expected_bytes: "hex:736f6961edfffffeff",
        alternative_jsons: [],
        alternative_bytes: [],
        expected_type_descriptor: null,
      },
    },
  },
  {
    test_number: 1016,
    assertion: {
      kind: "value_bundle",
      value: {
        value: {
          kind: "int32",
          value: -2147483648,
        },
        expected_dense_json: "-2147483648",
        expected_readable_json: "-2147483648",
        expected_bytes: "hex:736f6961ed00000080",
        alternative_jsons: [],
        alternative_bytes: [],
        expected_type_descriptor: null,
      },
    },
  },
  {
    test_number: 1017,
    assertion: {
      kind: "value_bundle",
      value: {
        value: {
          kind: "int64",
          value: 888888888888,
        },
        expected_dense_json: "888888888888",
        expected_readable_json: "888888888888",
        expected_bytes: "hex:736f6961ee380ee8f5ce000000",
        alternative_jsons: [],
        alternative_bytes: [],
        expected_type_descriptor: "{\n  \"type\": {\n    \"kind\": \"primitive\",\n    \"value\": \"int64\"\n  },\n  \"records\": []\n}",
      },
    },
  },
  {
    test_number: 1018,
    assertion: {
      kind: "value_bundle",
      value: {
        value: {
          kind: "int64",
          value: 9223372036854775807,
        },
        expected_dense_json: "\"9223372036854775807\"",
        expected_readable_json: "\"9223372036854775807\"",
        expected_bytes: "hex:736f6961eeffffffffffffff7f",
        alternative_jsons: [],
        alternative_bytes: [],
        expected_type_descriptor: null,
      },
    },
  },
  {
    test_number: 1019,
    assertion: {
      kind: "value_bundle",
      value: {
        value: {
          kind: "int64",
          value: -9223372036854775808,
        },
        expected_dense_json: "\"-9223372036854775808\"",
        expected_readable_json: "\"-9223372036854775808\"",
        expected_bytes: "hex:736f6961ee0000000000000080",
        alternative_jsons: [],
        alternative_bytes: [],
        expected_type_descriptor: null,
      },
    },
  },
  {
    test_number: 1020,
    assertion: {
      kind: "value_bundle",
      value: {
        value: {
          kind: "int64",
          value: 9007199254740991,
        },
        expected_dense_json: "9007199254740991",
        expected_readable_json: "9007199254740991",
        expected_bytes: "hex:736f6961eeffffffffffff1f00",
        alternative_jsons: [],
        alternative_bytes: [],
        expected_type_descriptor: null,
      },
    },
  },
  {
    test_number: 1021,
    assertion: {
      kind: "value_bundle",
      value: {
        value: {
          kind: "int64",
          value: 9007199254740992,
        },
        expected_dense_json: "\"9007199254740992\"",
        expected_readable_json: "\"9007199254740992\"",
        expected_bytes: "hex:736f6961ee0000000000002000",
        alternative_jsons: [],
        alternative_bytes: [],
        expected_type_descriptor: null,
      },
    },
  },
  {
    test_number: 1022,
    assertion: {
      kind: "value_bundle",
      value: {
        value: {
          kind: "int64",
          value: -9007199254740991,
        },
        expected_dense_json: "-9007199254740991",
        expected_readable_json: "-9007199254740991",
        expected_bytes: "hex:736f6961ee010000000000e0ff",
        alternative_jsons: [],
        alternative_bytes: [],
        expected_type_descriptor: null,
      },
    },
  },
  {
    test_number: 1023,
    assertion: {
      kind: "value_bundle",
      value: {
        value: {
          kind: "int64",
          value: -9007199254740992,
        },
        expected_dense_json: "\"-9007199254740992\"",
        expected_readable_json: "\"-9007199254740992\"",
        expected_bytes: "hex:736f6961ee000000000000e0ff",
        alternative_jsons: [],
        alternative_bytes: [],
        expected_type_descriptor: null,
      },
    },
  },
  {
    test_number: 1024,
    assertion: {
      kind: "value_bundle",
      value: {
        value: {
          kind: "uint64",
          value: 255,
        },
        expected_dense_json: "255",
        expected_readable_json: "255",
        expected_bytes: "hex:736f6961e8ff00",
        alternative_jsons: [],
        alternative_bytes: [],
        expected_type_descriptor: "{\n  \"type\": {\n    \"kind\": \"primitive\",\n    \"value\": \"uint64\"\n  },\n  \"records\": []\n}",
      },
    },
  },
  {
    test_number: 1025,
    assertion: {
      kind: "value_bundle",
      value: {
        value: {
          kind: "uint64",
          value: 65535,
        },
        expected_dense_json: "65535",
        expected_readable_json: "65535",
        expected_bytes: "hex:736f6961e8ffff",
        alternative_jsons: [],
        alternative_bytes: [],
        expected_type_descriptor: null,
      },
    },
  },
  {
    test_number: 1026,
    assertion: {
      kind: "value_bundle",
      value: {
        value: {
          kind: "uint64",
          value: 4294967295,
        },
        expected_dense_json: "4294967295",
        expected_readable_json: "4294967295",
        expected_bytes: "hex:736f6961e9ffffffff",
        alternative_jsons: [],
        alternative_bytes: [],
        expected_type_descriptor: null,
      },
    },
  },
  {
    test_number: 1027,
    assertion: {
      kind: "value_bundle",
      value: {
        value: {
          kind: "uint64",
          value: 18446744073709551615,
        },
        expected_dense_json: "\"18446744073709551615\"",
        expected_readable_json: "\"18446744073709551615\"",
        expected_bytes: "hex:736f6961eaffffffffffffffff",
        alternative_jsons: [],
        alternative_bytes: [],
        expected_type_descriptor: null,
      },
    },
  },
  {
    test_number: 1028,
    assertion: {
      kind: "value_bundle",
      value: {
        value: {
          kind: "float32",
          value: 3.14,
        },
        expected_dense_json: "3.14",
        expected_readable_json: "3.14",
        expected_bytes: "hex:736f6961f0c3f54840",
        alternative_jsons: [],
        alternative_bytes: [],
        expected_type_descriptor: "{\n  \"type\": {\n    \"kind\": \"primitive\",\n    \"value\": \"float32\"\n  },\n  \"records\": []\n}",
      },
    },
  },
  {
    test_number: 1029,
    assertion: {
      kind: "value_bundle",
      value: {
        value: {
          kind: "float64",
          value: 3.14,
        },
        expected_dense_json: "3.14",
        expected_readable_json: "3.14",
        expected_bytes: "hex:736f6961f11f85eb51b81e0940",
        alternative_jsons: [],
        alternative_bytes: [],
        expected_type_descriptor: "{\n  \"type\": {\n    \"kind\": \"primitive\",\n    \"value\": \"float64\"\n  },\n  \"records\": []\n}",
      },
    },
  },
  {
    test_number: 1030,
    assertion: {
      kind: "value_bundle",
      value: {
        value: {
          kind: "float64",
          value: -3.14,
        },
        expected_dense_json: "-3.14",
        expected_readable_json: "-3.14",
        expected_bytes: "hex:736f6961f11f85eb51b81e09c0",
        alternative_jsons: [],
        alternative_bytes: [],
        expected_type_descriptor: null,
      },
    },
  },
  {
    test_number: 1031,
    assertion: {
      kind: "value_bundle",
      value: {
        value: {
          kind: "string",
          value: "",
        },
        expected_dense_json: "\"\"",
        expected_readable_json: "\"\"",
        expected_bytes: "hex:736f6961f2",
        alternative_jsons: [
          {
            kind: "literal",
            value: "0",
          },
        ],
        alternative_bytes: [],
        expected_type_descriptor: "{\n  \"type\": {\n    \"kind\": \"primitive\",\n    \"value\": \"string\"\n  },\n  \"records\": []\n}",
      },
    },
  },
  {
    test_number: 1032,
    assertion: {
      kind: "value_bundle",
      value: {
        value: {
          kind: "string",
          value: "Foôbar",
        },
        expected_dense_json: "\"Foôbar\"",
        expected_readable_json: "\"Foôbar\"",
        expected_bytes: "hex:736f6961f307466fc3b4626172",
        alternative_jsons: [],
        alternative_bytes: [],
        expected_type_descriptor: null,
      },
    },
  },
  {
    test_number: 1033,
    assertion: {
      kind: "value_bundle",
      value: {
        value: {
          kind: "string",
          value: 'Foo\n"bar"',
        },
        expected_dense_json: '"Foo\\n\\"bar\\""',
        expected_readable_json: '"Foo\\n\\"bar\\""',
        expected_bytes: "hex:736f6961f309466f6f0a2262617222",
        alternative_jsons: [],
        alternative_bytes: [],
        expected_type_descriptor: null,
      },
    },
  },
  {
    test_number: 1034,
    assertion: {
      kind: "value_bundle",
      value: {
        value: {
          kind: "string",
          value: "ééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééé",
        },
        expected_dense_json: '"ééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééé"',
        expected_readable_json: '"ééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééé"',
        expected_bytes: "hex:736f6961f3e8fe01c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9c3a9",
        alternative_jsons: [],
        alternative_bytes: [],
        expected_type_descriptor: null,
      },
    },
  },
  {
    test_number: 1035,
    assertion: {
      kind: "value_bundle",
      value: {
        value: {
          kind: "bytes",
          value: "hex:f50469b735",
        },
        expected_dense_json: '"9QRptzU="',
        expected_readable_json: '"hex:f50469b735"',
        expected_bytes: "hex:736f6961f505f50469b735",
        alternative_jsons: [],
        alternative_bytes: [],
        expected_type_descriptor: "{\n  \"type\": {\n    \"kind\": \"primitive\",\n    \"value\": \"bytes\"\n  },\n  \"records\": []\n}",
      },
    },
  },
  {
    test_number: 1036,
    assertion: {
      kind: "value_bundle",
      value: {
        value: {
          kind: "bytes",
          value: "hex:",
        },
        expected_dense_json: '""',
        expected_readable_json: '"hex:"',
        expected_bytes: "hex:736f6961f4",
        alternative_jsons: [
          {
            kind: "literal",
            value: "0",
          },
        ],
        alternative_bytes: [],
        expected_type_descriptor: null,
      },
    },
  },
];
