struct UnitTest {
  test_number: int32;
  assertion: Assertion;
}

enum Assertion {
  struct BytesEqual {
    actual: BytesExpression;
    expected: BytesExpression;
  }
  bytes_equal: BytesEqual;

  struct StringEqual {
    actual: StringExpression;
    expected: StringExpression;
  }
  string_equal: StringEqual;

  struct ValueBundle {
    value: TypedValue;
    expected_dense_json: string;
    expected_readable_json: string;
    alternative_jsons: [StringExpression];
    expected_bytes: bytes;
    alternative_bytes: [BytesExpression];
    expected_type_descriptor: string?;
  }
  value_bundle: ValueBundle;
}

enum StringExpression {
  literal: string;
  to_dense_json: TypedValue;
  to_readable_json: TypedValue;
  point_to_dense_json: PointExpression;
  point_to_readable_json: PointExpression;
}

enum BytesExpression {
  literal: bytes;
  to_bytes: TypedValue;
  point_to_bytes: PointExpression;
}

enum TypedValue {
  bool: bool;
  int32: int32;
  int64: int64;
  uint64: uint64;
  float32: float32;
  float64: float64;
  timestamp: timestamp;
  string: string;
  bytes: bytes;
  bool_optional: bool?;
  ints: [int32];
  point: Point;
  color: Color;
  round_trip_dense_json: TypedValue;
  round_trip_readable_json: TypedValue;
  round_trip_bytes: TypedValue;
}

enum PointExpression {
  literal: Point;
  from_json_keep_unrecognized: StringExpression;
  from_json_drop_unrecognized: StringExpression;
  from_bytes_keep_unrecognized: BytesExpression;
  from_bytes_drop_unrecognized: BytesExpression;
}

struct Point {
  x: int32;
  removed;
  y: int32;
}

struct Color {
  r: int32;
  g: int32;
  b: int32;
  removed;
}

const UNIT_TESTS: [UnitTest] = [
  {
    test_number: 1000,
    assertion: {
      kind: "value_bundle",
      value: {
        value: {
          kind: "bool",
          value: true,
        },
        expected_dense_json: "1",
        expected_readable_json: "true",
        alternative_jsons: [
          {
            kind: "literal",
            value: "3.14",
          },
          {
            kind: "literal",
            value: "-1",
          },
          {
            kind: "literal",
            value: '"-Infinity"',
          },
        ],
        expected_bytes: "hex:736f696101",
        alternative_bytes: [
          {
            kind: "to_bytes",
            value: {
              kind: "float32",
              value: 3.14,
            },
          },
        ],
        expected_type_descriptor: "{\n  \"type\": {\n    \"kind\": \"primitive\",\n    \"value\": \"bool\"\n  },\n  \"records\": []\n}",
      },
    },
  },
  {
    test_number: 1001,
    assertion: {
      kind: "value_bundle",
      value: {
        value: {
          kind: "bool",
          value: false,
        },
        expected_dense_json: "0",
        expected_readable_json: "false",
        expected_bytes: "hex:736f696100",
        alternative_jsons: [
          {
            kind: "literal",
            value: "0.0",
          },
          {
            kind: "literal",
            value: "-0.0",
          },
        ],
        alternative_bytes: [],
        expected_type_descriptor: null,
      },
    },
  },
  {
    test_number: 1002,
    assertion: {
      kind: "value_bundle",
      value: {
        value: {
          kind: "timestamp",
          value: "1970-01-01T00:00:00.000Z",
        },
        expected_dense_json: "0",
        expected_readable_json: '{\n  "unix_millis": 0,\n  "formatted": "1970-01-01T00:00:00.000Z"\n}',
        expected_bytes: "hex:736f696100",
        alternative_jsons: [
          {
            kind: "literal",
            value: "0.0",
          },
        ],
        alternative_bytes: [],
        expected_type_descriptor: "{\n  \"type\": {\n    \"kind\": \"primitive\",\n    \"value\": \"timestamp\"\n  },\n  \"records\": []\n}",
      },
    },
  },
  {
    test_number: 1003,
    assertion: {
      kind: "value_bundle",
      value: {
        value: {
          kind: "timestamp",
          value: "2023-08-25T21:30:34.586Z",
        },
        expected_dense_json: "1692999034586",
        expected_readable_json: '{\n  "unix_millis": 1692999034586,\n  "formatted": "2023-08-25T21:30:34.586Z"\n}',
        expected_bytes: "hex:736f6961efda269b2e8a010000",
        alternative_jsons: [
          {
            kind: "literal",
            value: "\"1692999034586\"",
          },
        ],
        alternative_bytes: [
          {
            kind: "to_bytes",
            value: {
              kind: "float64",
              value: 1692999034586.1,
            },
          },
        ],
        expected_type_descriptor: null,
      },
    },
  },
  {
    test_number: 1004,
    assertion: {
      kind: "value_bundle",
      value: {
        value: {
          kind: "int32",
          value: 2,
        },
        expected_dense_json: "2",
        expected_readable_json: "2",
        expected_bytes: "hex:736f696102",
        alternative_jsons: [
          {
            kind: "literal",
            value: "\"2\"",
          },
        ],
        alternative_bytes: [
          {
            kind: "to_bytes",
            value: {
              kind: "float64",
              value: 2.0,
            },
          },
        ],
        expected_type_descriptor: "{\n  \"type\": {\n    \"kind\": \"primitive\",\n    \"value\": \"int32\"\n  },\n  \"records\": []\n}",
      },
    },
  },
  {
    test_number: 1005,
    assertion: {
      kind: "value_bundle",
      value: {
        value: {
          kind: "int32",
          value: -1,
        },
        expected_dense_json: "-1",
        expected_readable_json: "-1",
        expected_bytes: "hex:736f6961ebff",
        alternative_jsons: [
          {
            kind: "literal",
            value: "\"-1\"",
          },
        ],
        alternative_bytes: [],
        expected_type_descriptor: null,
      },
    },
  },
  {
    test_number: 1006,
    assertion: {
      kind: "value_bundle",
      value: {
        value: {
          kind: "int32",
          value: 231,
        },
        expected_dense_json: "231",
        expected_readable_json: "231",
        expected_bytes: "hex:736f6961e7",
        alternative_jsons: [],
        alternative_bytes: [],
        expected_type_descriptor: null,
      },
    },
  },
  {
    test_number: 1007,
    assertion: {
      kind: "value_bundle",
      value: {
        value: {
          kind: "int32",
          value: 232,
        },
        expected_dense_json: "232",
        expected_readable_json: "232",
        expected_bytes: "hex:736f6961e8e800",
        alternative_jsons: [],
        alternative_bytes: [],
        expected_type_descriptor: null,
      },
    },
  },
  {
    test_number: 1008,
    assertion: {
      kind: "value_bundle",
      value: {
        value: {
          kind: "int32",
          value: 65535,
        },
        expected_dense_json: "65535",
        expected_readable_json: "65535",
        expected_bytes: "hex:736f6961e8ffff",
        alternative_jsons: [],
        alternative_bytes: [],
        expected_type_descriptor: null,
      },
    },
  },
  {
    test_number: 1009,
    assertion: {
      kind: "value_bundle",
      value: {
        value: {
          kind: "int32",
          value: 65536,
        },
        expected_dense_json: "65536",
        expected_readable_json: "65536",
        expected_bytes: "hex:736f6961e900000100",
        alternative_jsons: [],
        alternative_bytes: [],
        expected_type_descriptor: null,
      },
    },
  },
  {
    test_number: 1010,
    assertion: {
      kind: "value_bundle",
      value: {
        value: {
          kind: "int32",
          value: 2147483647,
        },
        expected_dense_json: "2147483647",
        expected_readable_json: "2147483647",
        expected_bytes: "hex:736f6961e9ffffff7f",
        alternative_jsons: [],
        alternative_bytes: [],
        expected_type_descriptor: null,
      },
    },
  },
  {
    test_number: 1011,
    assertion: {
      kind: "value_bundle",
      value: {
        value: {
          kind: "int32",
          value: -255,
        },
        expected_dense_json: "-255",
        expected_readable_json: "-255",
        expected_bytes: "hex:736f6961eb01",
        alternative_jsons: [],
        alternative_bytes: [],
        expected_type_descriptor: null,
      },
    },
  },
  {
    test_number: 1012,
    assertion: {
      kind: "value_bundle",
      value: {
        value: {
          kind: "int32",
          value: -256,
        },
        expected_dense_json: "-256",
        expected_readable_json: "-256",
        expected_bytes: "hex:736f6961eb00",
        alternative_jsons: [],
        alternative_bytes: [],
        expected_type_descriptor: null,
      },
    },
  },
  {
    test_number: 1013,
    assertion: {
      kind: "value_bundle",
      value: {
        value: {
          kind: "int32",
          value: -257,
        },
        expected_dense_json: "-257",
        expected_readable_json: "-257",
        expected_bytes: "hex:736f6961ecfffe",
        alternative_jsons: [],
        alternative_bytes: [],
        expected_type_descriptor: null,
      },
    },
  },
  {
    test_number: 1014,
    assertion: {
      kind: "value_bundle",
      value: {
        value: {
          kind: "int32",
          value: -65536,
        },
        expected_dense_json: "-65536",
        expected_readable_json: "-65536",
        expected_bytes: "hex:736f6961ec0000",
        alternative_jsons: [],
        alternative_bytes: [],
        expected_type_descriptor: null,
      },
    },
  },
  {
    test_number: 1015,
    assertion: {
      kind: "value_bundle",
      value: {
        value: {
          kind: "int32",
          value: -65537,
        },
        expected_dense_json: "-65537",
        expected_readable_json: "-65537",
        expected_bytes: "hex:736f6961edfffffeff",
        alternative_jsons: [],
        alternative_bytes: [],
        expected_type_descriptor: null,
      },
    },
  },
  {
    test_number: 1016,
    assertion: {
      kind: "value_bundle",
      value: {
        value: {
          kind: "int32",
          value: -2147483648,
        },
        expected_dense_json: "-2147483648",
        expected_readable_json: "-2147483648",
        expected_bytes: "hex:736f6961ed00000080",
        alternative_jsons: [],
        alternative_bytes: [],
        expected_type_descriptor: null,
      },
    },
  },
];
